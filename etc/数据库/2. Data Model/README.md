# Data Model

[数据模型](https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B)（[data model](https://en.wikipedia.org/wiki/Data_model)）是一种模型，是对现实世界数据特征的抽象。也就是说，数据模型是用来描述数据、组织数据和对数据进行操作的。

[TOC] 

## **零. Introduction**

现有数据库均是基于某种数据库模型的。数据库模型是数据库系统的核心和基础。

### :package: 两类数据模型

数据模型应满足三方面要求：

- 比较真实地模拟现实世界。
- 容易为人所理解
- 便于在计算机上实现

如同在:building_construction:建筑设计的不同阶段需要不同的图纸:page_with_curl: 一样，在开发实施数据库应用系统中也需要使用不同的数据模型：**概念模型**、**逻辑模型**、**物理模型**。

<img src="https://github.com/terminator-128/FairLand.github.io/raw/master/pictures/Different_Level_of_abstraction_of_datamodel.png" style="width:80%;" />

根据模型应用的不同目的，可以将这些模型分为两大类，它们分别属于两个不同的层次：

- 概念模型（conceptual model）：按用户观点来对数据库和信息进行建模。主要用于数据库设计。

  >  概念模型也称为信息模型。

- 逻辑模型和物理模型
  - 逻辑模型（logical model）：按照计算机系统的观点对数据建模，主要用于数据库管理系统的实现。
    - 层次模型（hierarchical model）
    - 网状模型（network model）
    - **关系模型**:family:（relational model）
    - 面向对象模型（object-oriented data model）
    - 对象关系数据模型（object-relational data model）
    - 半结构化数据模型（semistructured data model）
    - ···
    
  - 物理模型（physical model）：描述数据在系统内部的表示方式和存取方法，或在磁盘或磁带上的存储方式和存取方法，是面向计算机系统的。
  
    > 物理模型具有的是数据库管理系统的任务，数据库设计人员要了解和选择物理模型，最终用户则不必考虑物理级的细节。

<img src="https://github.com/terminator-128/FairLand.github.io/raw/master/pictures/change_abstract_model.png" style="width:82%;" />

### :palm_tree: 数据的抽象

- 从**现实世界**到**概念模型**的转换：数据库设计人员
- 从**概念模型**到**逻辑模型**的转换：数据库设计人员或数据库管理人员
- 从**逻辑模型**到**物理模型**的转换：数据库管理系统

---



## 一、概念模型

由上文我们得知，概念模型实际上是现实世界到机器世界的一个中间层次。

**概念模型用于信息世界的建模，是现实世界到信息世界的第一层抽象**，是数据库设计人员进行数据库设计的有力工具，也是数据库设计人员到信息世界的第一层抽象，是数据库设计人员和用户之间进行交流的语言。

对概念模型的要求：

- 具有较强的语义表达能力，能够方便、直接地表达应用中的各种语义知识。
- 简单、清晰、易于用户理解。

### 1. 信息世界中的基本概念

#### **（1）实体（entity）**

​	客观存在并可相互区别的事物称为实体。

> 实体可以是具体的人事物，也可以是抽象的概念和联系。注意不是一类，是一个；不是实体型，而是具体的一个对象。

[^例如]: 一个职工、一个学生、一个部门、一门课、学生的一次选课、部门的一次订货、教师与院系的工作关系等都是实体。

#### **（2）属性（attribute）**

​	实体所具有的某一特性称为属性。

> 一个实体可以由若干个属性来判断。属性组成的向量可以表征某个实体。

[^例如]: 学生实体可以由学号、姓名、性别、出生年月、所在院系、入学时间等属性组成。属性组合（20131521，夏理钧，男，200002，医学系，2018）即表征了一个学生。

#### **（3）码（key）**

​	唯一标识实体的属性集称为码。

> 主码和候选码均可唯一的标识模式中的实体。

[^例如]: 学号是学生实体的码；身份证号是中国公民的码:information_desk_person:。

#### **（4）实体型（entity type）**

​	具有相同属性的实体必然具有共同的特征和性质，用实体名及其属性名集合来抽象和刻画同类实体，称为实体型。

> 有点类似于 Schema ？:) (雾)

[^例如]: 学生（学号，姓名，性别，出生年月，所在院系，入学时间）就是一个实体型

#### **（5）实体集（entity set）**

​	同一类型的实体的集合称为实体集。

> 笔者jio得实体型是表头的话，实体集就可以表示为表中的所有记录。

[^例如]: 长郡中学全体学生就是一个实体集。

#### **（6）联系（relationship）**

​	在现实世界中，事物内部以及事物之间是有联系的，这些联系在信息世界中反映为实体（型）内部的联系和实体（型）之间的联系。

>  实体内部的联系通常是指组成各实体的各属性之间的联系；实体之间的联系通常是指不同实体集之间的联系。

​	实体之间的联系有**一对一**、**一对多**和**多对多**等多种类型。

- 一对一关系：对于实体集A中的每一个实体，在实体集B中至多有一个（也可以没有）实体与之联系；反之亦然。则称实体集A与实体集B具有一对一联系。

  > 夫妻关系。:couple:

- 一对多关系：对于实体集A中的每一个实体，在实体集B中有n个（n$\ge$0）实体与之联系；反之，对于实体集B中的每一个实体，在实体集A中至多有一个（也可以没有）实体与之联系。则称实体集A与实体集B之间有一对多的联系。

  > 领导关系。:bow:

- 多对多关系：对于实体集A中的每一个实体，在实体集B中有n个（n$\ge$0）实体与之联系；反之，对于实体集B中的每一个实体，在实体集B中有m个（m$\ge$0）实体与之联系。则称实体集A与实体集B有多对多联系。

  > 选课关系。:alarm_clock:

### 2. 实体-联系方法——概念模型的一种表示方法

概念模型是对信息世界的建模，所以概念模型应该能够方便、准确地表示出上述信息世界的常用概念。概念模型的表示方法很多，其中最为常用的是P.P.S.Chen于1976年提出的实体-联系方法（Entity-Relationship approach）。该方法用E-R图（E-R diagram）来描述现实世界的概念模型，E-R方法也称为E-R模型。

---



## 二、数据模型的组成要素

一般地讲，数据模型是严格定义的一组概念的集合。这些概念精确地描述了系统的静态特性、动态特性和完整性约束条件（integrity constraints）。因此数据模型通常由**数据结构**、**数据操作**和**数据的完整性约束条件**组成。

### 1. 数据结构（Data Structure）

数据结构描述数据库的组成对象以及对象之间的联系。

> 也就是说数据结构描述的内容有两类：
>
> 一类是与对象的类型、内容、性质有关的，如网状模型中的数据项、记录，关系模型中的域、属性、关系等；
>
> 一类是数据之间联系有关的对象，如网状模型中的系型（set type）。

数据结构是刻画一个数据模型性质最重要的方面。因此在数据库系统中，人们通常按照数据结构的类型来命名数据模型。

> 层次结构、网状结构和关系结构的数据模型分别命名为层次模型、网状模型和关系模型。

数据结构是所描述的对象类型的集合，是对**系统静态特性**的描述。

### 2. 数据操作（Data Operation）

数据操作是指对数据库中各种对象（型）的实例（值）允许执行的操作的集合，包括操作及其有关的规则。

> 数据库主要有查询和更新（包括插入、删除、修改）两大操作。
>
> 数据模型必须定义这些操作的确切含义、操作符号、操作规则（如优先级）以及实现操作的语言（如SQL）

数据操作是对**系统动态特性**的描述。

### 3. 完整性约束条件（Data Constraints）

数据的完整性约束条件是一组完整性规则。

> 完整性规则是给定的数据模型中数据及其联系所具有的制约和依存规则，用以限定符合数据模型的数据库状态以及状态的变化，以保证数据的正确、有效和相容。

数据模型应该反应和规定其必须遵守的基本的和通用的完整性约束条件。

> 例如，在关系模型中，任何关系必须满足实体完整性和参照完整性两个条件。（在之后有关章节会具体讨论）

数据模型还应该提供定义完整性条件的机制，以反映具体应用所涉及的数据必须遵守的特定的语义约束条件。

> 例如，某大学的数据库中规定学生成绩如果有六门以上的不及格将不能授予学士学位，教授的退休年龄是65周岁，男职工的退休年龄是60周岁，女职工的退休年龄是55周岁。

---



## 三、常用的数据模型



数据库领域主要的逻辑数据模型有：

- 格式化模型（formatted model）
  - 层次模型（[hierarchical model](https://en.wikipedia.org/wiki/Hierarchical_database_model)）：树形结构
  - 网状模型（[network model](https://en.wikipedia.org/wiki/Network_model)）：网状结构
- 关系模型（[relational model](https://en.wikipedia.org/wiki/Relational_model)）
- [面向对象数据模型](https://baike.baidu.com/item/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B)（object-oriented data model）
- 对象关系数据模型（object-relational data model）
- 半结构化模型（[semistructure data model](https://en.wikipedia.org/w/index.php?title=Semi-structured_model&gettingStartedReturn=true)）

### 1. 数据模型简介

##### **（1）格式化模型**

**格式化模型**的数据库系统在使用和实现上都要涉及数据库物理层的复杂结构，现在已逐渐被关系模型的数据库取代。

> 但在美国及欧洲的一些国家里，由于早期开发的应用系统都是基于层次数据系统的，因此膜前荣勇一些层次的数据库系统或网状数据库系统在继续使用。

##### **（2）半结构化数据模型**

**半结构化数据模型**创造了数据（data）不受模式（schema）拘束的模型，为数据在不同类型数据库之间传递提供了一种灵活的形式。

> 由于有助于以非结构化方式查看结构化数据（为浏览器目的设计）；模式较容易改变；数据（data）传输格式可能是可移植的。
>
> > 随着Internet发展，Web出现的各种半结构化、非结构化数据源成为重要的信息来源，产生了以XML为代表的半结构化数据模型和非结构化数据模型。

##### **（3）面向对象数据模型**

**面向对象数据模型**是随着面向对象数据库研究与开发的一条路线（纯粹的[面向对象数据库](https://en.wikipedia.org/wiki/Object_database)管理系统（OODBMS））。

> 面向对象数据库系统对一些特定的应用领域（例如计算机辅助设计）能较好的满足其需求，但因为不支持结构查询语言SQL而失去通用性。

##### **（4）对象-关系数据模型**

**对象-关系数据模型**是随着**支持对象特征**的**关系数据库**而建立的（使用[对象关系数据库](https://en.wikipedia.org/wiki/Object-relational_database)），是面向对象数据库研究与开发的一条路线（关系数据库和结构查询语言（SQL）为基础加以扩展，增加面对对象的特征）的研究成果。

> 简单来说，就是既支持支持对象（静态属性、动态行为、扩展数据类型、继承等特征）也支持传统数据库特征（支持SQL）的扩展模型。



---

### **2. 关系模型**

关系模型是最重要的一种数据模型。关系数据库系统采用关系模型作为数据的组织方式。

> 1970年，美国IBM公司San Jose研究室的研究员E.F.Codd首次提出了数据库系统的关系模型，开创了数据库关系方法和关系数据理论的研究，为数据库技术奠定了理论基础。由于E.F.Codd的杰出工作，他于1981年获得ACM图灵奖。

由于20世纪80年代以来，计算机厂商推出的数据库管理系统几乎都支持关系模型，非关系系统的产品也大都加上了关系接口。数据库当前的研究工作也都是以关系方法为基础。因此，本文的重点也在关系数据库上，其他各模型会在需要时补充。

<img src="https://github.com/terminator-128/FairLand.github.io/raw/master/pictures/relation_model.png" style="width:80%;" />

### （1）关系模型的数据结构

​	关系模型与以往的模型不同，他时间在严格地数学概念的基础上的。

> Codd论述范式理论和衡量关系系统的12条规则奠定的数学模型理论。

严格的定义将在之后介绍”关系数据库“中给出，下面简单勾画下关系模型：

> 从用户观点看，关系模型由一组关系组成。每个关系的数据结构都是一张规范化的二维表。下面以学生登记表为例，介绍关系模型的一些术语。‘

**学生登记表：**

|  学号   |  姓名  | 年龄 | 性别 |   系名   | 年级 |
| :-----: | :----: | :--: | :--: | :------: | :--: |
| 2020001 | 程序员 |  20  |  男  | 计算机系 | 2018 |
| 2020002 |  柳永  | null |  男  |  文学系  | 2018 |
| 2020003 | 马则奇 |  19  |  男  |  多媒体  | 2018 |
| 2020004 |  王燕  |  20  |  女  |  自动化  | 2018 |
|   ···   |  ···   | ···  | ···  |   ···    | ···  |

##### :red_circle:关系（relation）：一个关系通常对应一张表。

> 如上述关系：学生登记表

##### :large_blue_circle:元组（tuple）：表中的一行即为一个元组。

> 如登记表中（2020001，程序员，20，计算机，2018）

##### :white_circle:属性（attribute）：表中的一列

> 如上述关系的学号（2020001，2020002,2020003）。

##### :key:码（key）：也称码键。表中的某个属性组，它可以唯一的确定一个元组。

> 如学生的学号可做学生登记关系的码

##### :fish:域（domain）：域是一组具有相同数据类型的值的集合。属性的取值范围来自某个域。

> 如性别的域为（男，女）

##### :balance_scale:分量（component）：元祖中的一个属性值。

> 元组（2020001，程序员，20，男，计算机，2018）中学号 2020001就是元祖中的一个属性值。

##### :pager:关系模式（relational schema）：对关系的描述,一般表示为 关系名（属性1，属性2，···，属性n）

> 例如，上述学生登记表的可描述为 	学生（学号，姓名，年龄，系名，年级）

关系模型要求关系必须是规范化的，及要求关系必须满足一定的规范条件，这些条件中最基本的一条就是，关系的每个分量必须是一个不可分的数据项。

> 也就是说，不允许表中表的存在。

| 关系术语 | 一般表格的术语 |
| :-------- | :------------- |
| 关系名   |      表名      |
| 关系模式 |      表头      |
| 关系 | （一张）二维表 |
| 元组 | 记录或行 |
| 属性 | 列 |
| 属性名 | 列名 |
| 属性值 | 列值 |
| 分量 | 一条记录中的一个列值 |
| 非规范关系 | 表中有表（大表嵌小表） |



### （2）关系模型的数据操纵与完整性约束

关系模型的数据操作主要包括查询、插入、删除和更新数据。这些操作必须满足关系的完整性约束条件。

> 关系的完整性约束条件包括三大类：实体完整性、参照完整性和用户定义的完整性。

**关系模型中的数据操作是集合操作，操作对象和操作结果都是关系**

> 即若干元组的集合，而不像格式化模型那样是单记录的操作方式。

**关系模型把存取路径向用户隐蔽起来**

> 用户只要指出“干什么”或“找什么”，不必详细说明“怎么干”或“怎么找”，从而大大提高了数据独立性，提高了用户生产率。

### （3）关系模型的优缺点

​	关系模型由以下特点：

- 关系模型与格式化模型不同，它是建立在严格的数学基础之上的。

- 关系模型的概念单一。

  > 无论是实体还是实体之间的联系都用关系来表示。对数据的检索和更新结果也是关系（即表）。所以其数据结构简单、清晰，用户易懂易用。

- 关系模型的存取路径对用户透明，从而具有更高的数据独立性、更好的安全保密性，也简化了程序员的工作和数据库开发建立的工作。

  > 当然关系的缺点也来源于此，由于存取路径对用户是屏蔽的，查询效率往往不如格式化数据模型。
  >
  > 为了提高性能，数据库管理系统必须对用户的查询请求进行优化，因此增加了开发数据库管理系统的难度。不过用户不必考虑这些系统内部的优化技术细节。



